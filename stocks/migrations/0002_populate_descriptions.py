from django.db import migrations


def forwards(apps, schema_editor):
    Drug = apps.get_model('stocks', 'Drug')

    descriptions = {
        'Допамин': (
            'Применяется при шоковых состояниях и острой сердечной недостаточности. '
            'Повышает сердечный выброс и улучшает перфузию органов при низком давлении.'
        ),
        'Норадреналин': (
            'Используется при выраженной артериальной гипотензии и септическом шоке. '
            'Вызывает мощное сосудосуживающее действие и повышает системное артериальное давление.'
        ),
        'Адреналин': (
            'Показан при анафилактическом шоке, остановке сердца и тяжёлых аллергических реакциях. '
            'Обладает как сосудосуживающим, так и стимулирующим эффектом на сердце.'
        ),
        'Добутамин': (
            'Применяется при острой сердечной недостаточности и кардиогенном шоке для увеличения фракции выброса. '
            'Улучшает сократимость миокарда с минимальным повышением нагрузки на сердце.'
        ),
        'Фенилэфрин': (
            'Используется при симптоматической артериальной гипотензии для быстрого повышения давления. '
            'Действует преимущественно как сосудосуживающее средство.'
        ),
        'Эпинефрин': (
            'Альтернативное название — адреналин; применяется при анафилаксии, остановке сердца и тяжёлых аллергических состояниях. '
            'Комбинирует сосудосуживающее и кардиостимулирующее действие.'
        ),
        'Изопреналин': (
            'Применяется при брадикардии и некоторых формах блокады сердца для повышения частоты сердечных сокращений. '
            'Оказывает вазодилататорное и хронотропное влияние.'
        ),
        'Милринон': (
            'Применяется при острой декомпенсации сердечной недостаточности для повышения сократимости и снижения постнагрузки. '
            'Обладает инотропным и вазодилатирующим эффектом.'
        ),
        'Левосимендан': (
            'Используют при острой и хронической сердечной недостаточности для повышения сократительной функции миокарда. '
            'Улучшает гемодинамику за счёт комбинации инотропного и вазодилатирующего действия.'
        ),
        'Нитроглицерин': (
            'Применяется для сужения боли в грудной клетке при ишемии и для снижения пред- и постнагрузки при острой сердечной недостаточности. '
            'Вызывает быстрое расширение венозного русла и улучшает коронарный кровоток.'
        ),
        'Нитропруссид': (
            'Используется при гипертонических кризах и для быстрого снижения артериального давления. '
            'Оказывает мощное артериовазодилатирующее действие; требует мониторинга и контроля дозы.'
        ),
        'Эсмолол': (
            'Короткодействующий бета-блокатор, применяемый при тахикардии и контроле частоты ритма в острых ситуациях. '
            'Подходит для кратковременной инфузии при необходимости быстрого восстановления частоты сердечных сокращений.'
        ),
        'Метопролол': (
            'Бета-блокатор, используемый при артериальной гипертензии, стенокардии и хронической сердечной недостаточности. '
            'Снижает частоту и силу сердечных сокращений, улучшая прогноз при ишемии.'
        ),
        'Верапамил': (
            'Кальциевый антагонист, применяемый при суправентрикулярной тахикардии и для снижения артериального давления. '
            'Замедляет атриовентрикулярную проводимость и уменьшает сократимость миокарда.'
        ),
    }

    for name, text in descriptions.items():
        # Обновляем только если поле пустое или содержит только пробелы
        qs = Drug.objects.filter(name=name)
        for obj in qs:
            if not obj.description or str(obj.description).strip() == '':
                obj.description = text
                obj.save()


def backwards(apps, schema_editor):
    # Ничего не делаем при откате — безопасный noop
    pass


class Migration(migrations.Migration):

    dependencies = [
        ('stocks', '0001_initial'),
    ]

    operations = [
        migrations.RunPython(forwards, backwards),
    ]
